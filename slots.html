<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gamblecore Slots</title>
<style>
  body {
    margin:0;
    font-family: 'Montserrat', sans-serif;
    background: linear-gradient(135deg,#071021 0%,#0c1223 100%);
    color:#fff;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    height:100vh;
  }
  h1 { color:#ffd66b; margin-bottom:10px; text-shadow:0 0 10px #ffd66b88; }
  #reels { display:flex; gap:15px; font-size:3rem; margin:20px 0; }
  button { padding:10px 20px; border:none; border-radius:8px; background:#ff4d4d; color:#fff; font-weight:700; cursor:pointer; margin:0 5px; }
  button:disabled { background:#555; cursor:not-allowed; }
  #total, #last { margin:8px 0; font-size:1.2rem; color:#cfcfcf; }
</style>
</head>
<body>

<h1>üé∞ Slots</h1>
<div id="reels">
  <div id="r1">‚ùì</div>
  <div id="r2">‚ùì</div>
  <div id="r3">‚ùì</div>
</div>

<div id="total">Total Points: 0</div>
<div id="last">Last: ‚Äî</div>

<div>
  <button id="spin">SPIN</button>
  <button id="reset">RESET</button>
</div>

<script>
// --- CONFIG ---
const symbols = ["üçí","üçã","üçä","üçâ","‚≠ê","üíé"];
const SPIN_DURATION = 1500; // spin in ms
const POINT_CAPS = [500,1000,1500]; // tiered caps
const REWARD_SMALL = 10; // small reward
const REWARD_MEDIUM = 30; // 2-match reward
const REWARD_JACKPOT = 100; // 3-match reward

// --- STATE ---
let currentCapIndex = 0;
let totalPoints = parseInt(localStorage.getItem('slotsTotal')) || 0;
let lastResult = '';
let chosenSymbol = null; // optional bias symbol
let spinButton = document.getElementById('spin');
let lastEl = document.getElementById('last');
let totalEl = document.getElementById('total');
const reels = [document.getElementById('r1'), document.getElementById('r2'), document.getElementById('r3')];

function getCurrentCap(){ return POINT_CAPS[currentCapIndex] || POINT_CAPS[POINT_CAPS.length-1]; }
function saveState(){ localStorage.setItem('slotsTotal', totalPoints); localStorage.setItem('slotsCapIndex', currentCapIndex); }

// --- FUNCTIONS ---
function updateUI(){
  totalEl.innerText = `Total Points: ${totalPoints}`;
  lastEl.innerText = `Last: ${lastResult}`;
  spinButton.disabled = totalPoints>=getCurrentCap();
}

function addPoints(pts){
  totalPoints = Math.min(getCurrentCap(), totalPoints + pts);
  lastResult = `${pts}pts`;
  saveState();
  if(totalPoints>=getCurrentCap()){
    spinButton.disabled=true;
    // Reset cap after 1 hour
    setTimeout(()=>{
      currentCapIndex = Math.min(currentCapIndex+1, POINT_CAPS.length-1);
      totalPoints = 0;
      saveState();
      updateUI();
    }, 60*60*1000);
  }
  updateUI();
}

// --- SPIN ---
spinButton.addEventListener('click', ()=>{
  if(totalPoints>=getCurrentCap()) return;
  const start = Date.now();
  const spinInterval = setInterval(()=>{
    reels.forEach(r=>{
      let pick;
      if(chosenSymbol && Math.random()<0.15) pick = chosenSymbol; // biased symbol
      else pick = symbols[Math.floor(Math.random()*symbols.length)];
      r.innerText = pick;
    });
    if(Date.now()-start>=SPIN_DURATION){
      clearInterval(spinInterval);
      const results = reels.map(r=>r.innerText);
      const [a,b,c] = results;
      let pts = REWARD_SMALL;

      // Jackpot
      if(a===b && b===c && Math.random()<0.1) pts = REWARD_JACKPOT;
      // 2 matches
      else if(a===b||b===c||a===c) pts = REWARD_MEDIUM;

      addPoints(pts);
      lastResult += ` (${results.join(' ')})`;
    }
  },80);
});

// --- RESET ---
document.getElementById('reset').addEventListener('click', ()=>{
  totalPoints=0; lastResult='‚Äî'; currentCapIndex=0;
  saveState();
  updateUI();
});

// --- INITIALIZE ---
currentCapIndex = parseInt(localStorage.getItem('slotsCapIndex')) || 0;
updateUI();
</script>

</body>
</html>
