<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Slots Simulator</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

  body {
    margin:0;
    font-family:'Montserrat',sans-serif;
    background: linear-gradient(135deg, #071021 0%, #0c1223 100%);
    color:#fff;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    height:100vh;
    padding:20px;
  }

  h1 { color:#ffd66b; text-shadow:0 0 15px #ffd66b55; margin-bottom:20px; }
  .reels { display:flex; justify-content:center; gap:10px; margin-bottom:20px; }
  .reel { background:#111; border:2px solid #2b2b2b; border-radius:12px; width:80px; height:80px; display:flex; justify-content:center; align-items:center; font-size:2.2rem; }
  button { padding:12px 24px; font-weight:700; border:none; border-radius:10px; cursor:pointer; background:#ff4d4d; color:#fff; transition:0.3s; }
  button:hover { background:#e63946; }
  #total { margin-top:15px; font-size:1.5rem; color:#ffd66b; }
  #timer { margin-top:5px; color:#9aa6b2; font-size:0.9rem; }
</style>
</head>
<body>

<h1>üé∞ Slot Machine</h1>
<div class="reels">
  <div class="reel" id="reel0">‚ùì</div>
  <div class="reel" id="reel1">‚ùì</div>
  <div class="reel" id="reel2">‚ùì</div>
</div>
<button id="spin">SPIN</button>
<div id="total">Total Points: 0</div>
<div id="timer">Next reset in: 01:00:00</div>

<script>
const STORAGE_KEY='slots.session.v1';
const CAP_INTERVAL=60*60*1000; // 1 hour
const BASE_CAP=500;
const SYMBOLS=['üçí','üçã','üçâ','‚≠ê','üîî','üíé','7Ô∏è‚É£'];
let total=0, capMultiplier=1, lastReset=Date.now(), spinning=false;

// Load localStorage
try{
  const saved=JSON.parse(localStorage.getItem(STORAGE_KEY));
  if(saved){
    const elapsed=Date.now()-saved.lastReset;
    total=saved.total||0;
    capMultiplier=saved.capMultiplier||1;
    lastReset=saved.lastReset||Date.now();
    if(elapsed>=CAP_INTERVAL){
      total=0;
      capMultiplier=1;
      lastReset=Date.now();
    }
  }
}catch{}

document.getElementById('total').innerText=`Total Points: ${total}`;

// Timer
function updateTimer(){
  const remaining=Math.max(0,CAP_INTERVAL-(Date.now()-lastReset));
  const hrs=Math.floor(remaining/3600000);
  const mins=Math.floor((remaining%3600000)/60000);
  const secs=Math.floor((remaining%60000)/1000);
  document.getElementById('timer').innerText=`Next reset in: ${hrs.toString().padStart(2,'0')}:${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
  if(remaining<=0){
    total=0;
    capMultiplier=1;
    lastReset=Date.now();
    localStorage.removeItem(STORAGE_KEY);
    document.getElementById('total').innerText=`Total Points: ${total}`;
  }
}
setInterval(updateTimer,1000);
updateTimer();

// Spin logic
document.getElementById('spin').addEventListener('click',()=>{
  if(spinning) return;
  spinning=true;
  const reels=[...document.querySelectorAll('.reel')];
  const chosenSymbol=SYMBOLS[Math.floor(Math.random()*SYMBOLS.length)];

  // Slow biased spin
  const spins=40;
  let count=0;
  const interval=setInterval(()=>{
    reels.forEach(r=>{
      if(Math.random()<0.35) r.innerText=chosenSymbol; 
      else r.innerText=SYMBOLS[Math.floor(Math.random()*SYMBOLS.length)];
    });
    count++;
    if(count>=spins){
      clearInterval(interval);
      const result=reels.map(r=>r.innerText);
      // Count matches
      let reward=0;
      const first=result[0];
      if(result.every(s=>s===first)) reward=50*capMultiplier; // full match
      else if(result[0]===result[1]||result[1]===result[2]||result[0]===result[2]) reward=20*capMultiplier; // partial
      total+=reward;
      const currentCap=BASE_CAP*capMultiplier;
      if(total>=currentCap){
        lastReset=Date.now();
        capMultiplier++;
      }
      if(total>BASE_CAP*capMultiplier) total=BASE_CAP*capMultiplier;
      document.getElementById('total').innerText=`Total Points: ${total}`;
      // Save
      localStorage.setItem(STORAGE_KEY,JSON.stringify({total,capMultiplier,lastReset}));
      spinning=false;
    }
  },100);
});
</script>
</body>
</html>
