<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pachinko</title>
<style>
body { margin:0; background:#000; display:flex; justify-content:center; align-items:center; height:100vh; color:#fff; font-family:monospace; }
#container { text-align:center; }
canvas { border-radius:10px; box-shadow:0 12px 40px rgba(0,0,0,0.7); display:block; margin:auto; background:#071021; }
button { padding:8px 14px; border-radius:8px; font-weight:800; margin:0 4px; cursor:pointer; }
#drop { background:#0f766e; color:#fff; }
#reset { background:#2b2b2b; color:#fff; }
#total { font-size:28px; margin-bottom:12px; }
#last { color:#9aa6b2; margin-top:10px; font-size:13px; }
#timer { color:#ffd66b; font-weight:bold; margin-bottom:8px; }
</style>
</head>
<body>
<div id="container">
  <div style="color:#ffd66b; font-weight:800; margin-bottom:8px;">Pachinko Points</div>
  <div id="timer"></div>
  <div id="total">0</div>
  <canvas id="pachinko" width="640" height="840"></canvas>
  <div style="margin-top:12px;">
    <button id="drop">DROP</button>
    <button id="reset">RESET POINTS</button>
  </div>
  <div id="last">Last: â€”</div>
</div>

<script>
const STORAGE_KEY = 'pachinkoTotal';
let totalPoints = parseInt(localStorage.getItem(STORAGE_KEY)) || 0;
let cap = parseInt(localStorage.getItem('pachinkoCap')) || 500;
let capReset = parseInt(localStorage.getItem('pachinkoReset')) || 0;

const totalEl = document.getElementById('total');
const timerEl = document.getElementById('timer');
const dropBtn = document.getElementById('drop');

function updateUI(){
  totalEl.textContent = totalPoints;
  const remaining = Math.max(0, capReset - Date.now());
  if(remaining>0){
    const mins = Math.floor(remaining/60000);
    const secs = Math.floor((remaining%60000)/1000);
    timerEl.textContent = `Next cap in ${mins}m ${secs}s`;
    dropBtn.disabled=true;
  } else {
    timerEl.textContent = '';
    dropBtn.disabled=false;
  }
}
updateUI();
setInterval(updateUI, 1000);

// --- Simplified pachinko scoring for demo ---
dropBtn.addEventListener('click', ()=>{
  if(totalPoints>=cap) return;
  let earned = Math.floor(Math.random()*50)+5; 
  totalPoints += earned;
  if(totalPoints>=cap){
    capReset = Date.now() + 60*60*1000;
    totalPoints = cap;
    localStorage.setItem('pachinkoCap', cap+500);
    localStorage.setItem('pachinkoReset', capReset);
  }
  localStorage.setItem(STORAGE_KEY, totalPoints);
  updateUI();
});
</script>
</body>
</html>
